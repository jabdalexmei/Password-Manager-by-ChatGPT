
# SPEC — VAULT-UI-FIX-06

## Deleted folder behavior + password visibility + password generator modal + unified eye icons + toasts position

## Goal

Fix the following UI issues in Vault / Create Data Card flow:

1. Selecting **Deleted** must NOT hide user-created folders.
2. In **Create Data Card**, the **Password field is visible by default** (not masked).
3. Replace the text **“Generate”** with an **icon button**, and implement a **Password Generator modal** with options shown in the reference screenshot.
4. Unify **eye icons** (visible/hidden) across the entire UI to use one shared SVG set.
5. Toast notifications must appear **at the top** of the screen (not bottom).

## Scope

Frontend only.

---

## 1) BUG: “Deleted” selection hides user folders

### Expected behavior

* The folder list must always show **all user-created folders**.
* “Deleted” is not a folder. It is a **navigation filter** for deleted data cards.
* Selecting “Deleted” must NOT replace the folder list with only deleted items (or empty state).

### Files to change

* `src/features/Vault/components/Folders/Folders.tsx`
* `src/features/Vault/useVault.ts` (only if selection state currently “switches data source”)

### Required changes

1. In `Folders.tsx`, render the sidebar in two independent sections:

   * **Navigation section**: “All items”, “Favorites”, “Archive”, **“Deleted”** (filters)
   * **Folders section**: the actual folders list (user folders)

2. The folders section must always render from `folders` (active folders), regardless of which nav filter is selected.

3. Remove any conditional logic like:

* `if (isTrashMode) render deleted folders`
* `if (selected === deleted) show different folder list`

4. “Deleted” click must only set `selectedNav = 'deleted'` (or equivalent), and trigger loading deleted cards list if needed, but must not impact folder list rendering.

### Acceptance

* User folders are always visible in the sidebar.
* Selecting “Deleted” only switches the cards list to deleted cards.

---

## 2) Create Data Card: Password is visible by default

### Expected behavior

* In the Create Data Card modal/form, the password input must be **type="text"** by default.
* The user can toggle to hidden using the eye icon, but initial state is visible.

### Files to change

* `src/features/Vault/components/modals/CreateDataCardModal.tsx`
  (or wherever the Create Data Card UI is implemented)

### Required changes

* Default state: `isPasswordHidden = false`
* Input:

  * when hidden: `<input type="password" ...>`
  * when visible: `<input type="text" ...>`

### Acceptance

* When Create Data Card opens, password characters are visible immediately.

---

## 3) Password Generator: icon button + modal UI (per reference)

### Expected behavior

* Replace the text button “Generate” near password input with an **icon-only** button.
* Clicking the icon opens a **Password Generator modal** matching the provided screenshot:

  * Generated password field (read-only) + copy button
  * Strength bar + “Strong (xxx bits)” label
  * Length slider with current value
  * Checkboxes:

    * Lowercase (a–z)
    * Uppercase (A–Z)
    * Numbers (0–9)
    * Symbols (!@#$%...)
    * Exclude similar characters (O, 0, I, 1, l)
  * Footer buttons: Cancel / Use
* Clicking **Use** sets the generated password into the Create Data Card password field and closes the modal.

### Files to add

* `src/features/Vault/components/modals/PasswordGeneratorModal.tsx`
* `src/features/Vault/utils/passwordGenerator.ts` (shared generator logic)

### Files to change

* `src/features/Vault/components/modals/CreateDataCardModal.tsx`
* `src/styles/ui.css` and/or `src/styles/screens/vault.css` (for modal styling if needed)

### Required UI wiring

1. In `CreateDataCardModal.tsx`:

   * Replace “Generate” text button with:

     * `<button className="icon-button" type="button" aria-label="Open password generator">...</button>`
   * The button must use the generator icon (see section 3.1)

2. Add local state:

* `isGeneratorOpen: boolean`

3. When modal closes with “Use(password)”, set password field value.

### 3.1 Generator icon asset

* Add the generator icon as a React component:

**File:** `src/components/icons/GenerateIcon.tsx`

* Use the provided image as the reference. Implement as SVG (vector), not png.
* Export: `GenerateIcon`

Then use it inside the icon button.

### 3.2 Generator logic requirements

**File:** `src/features/Vault/utils/passwordGenerator.ts`

* Must use **crypto.getRandomValues** (no Math.random).
* Must support toggles above.
* “Exclude similar” removes characters: `O 0 I 1 l` from all enabled sets.

### 3.3 Strength meter requirements

* Strength in “bits” must be computed as:

  * `bits = log2(charsetSize^length) = length * log2(charsetSize)`
* Display format: `Strong (103 bits)` exactly like screenshot (integer rounding is OK).
* Strength bar is purely visual (no backend).

### Acceptance

* Generator opens as modal, matches layout in screenshot, supports all toggles.
* Use inserts password to Create Data Card.
* Icon replaces text “Generate”.

---

## 4) Unified Eye icons (visible/hidden) everywhere

### Expected behavior

All “show/hide password” controls across the entire UI must use **one shared icon set**.

### Files to add

* `src/components/icons/EyeOpenIcon.tsx`
* `src/components/icons/EyeOffIcon.tsx`

### SVG definitions (must match exactly)

**EyeOffIcon** (hidden / crossed):

```svg
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M12 5C5 5 1 12 1 12s4 7 11 7 11-7 11-7-4-7-11-7z" />
  <circle cx="12" cy="12" r="3" />
  <line x1="3" y1="3" x2="21" y2="21" />
</svg>
```

**EyeOpenIcon** (visible):

```svg
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M12 5C5 5 1 12 1 12s4 7 11 7 11-7 11-7-4-7-11-7z" />
  <circle cx="12" cy="12" r="3" />
</svg>
```

### Files to change

Search and replace all current eye SVG usage in:

* `src/features/**`
* `src/components/**`

Replace inline SVGs with imports:

* `EyeOpenIcon`
* `EyeOffIcon`

### Acceptance

* All password show/hide buttons use the exact same SVG components.

---

## 5) Toast notifications must appear at the top

### Expected behavior

All toasts/alerts appear **top** (top-right or top-center is acceptable), never bottom.

### Files to change

Locate the toast container component and its styles. Typical files:

* `src/components/Toasts/Toasts.tsx` (or similar)
* `src/styles/toasts.css` or `src/styles/ui.css`

### Required change

Set the toast container to:

* `position: fixed;`
* `top: 16px;`
* `bottom: auto;`

Example CSS (must be applied to the actual toast container class used):

```css
.toast-container {
  position: fixed;
  top: 16px;
  bottom: auto;
  left: 0;
  right: 0;
  display: flex;
  justify-content: center; /* or flex-end if you want top-right */
  pointer-events: none;
  z-index: 9999;
}
.toast {
  pointer-events: auto;
}
```

### Acceptance

* Toasts always appear at the top right corner.

---

