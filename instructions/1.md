
# Technical Specification (EN): Replace “Use default path” checkbox with Toggle Switch in ExportBackupModal (keep behavior)

## Goal

In **Export backup** modal, replace the checkbox for “Use default path” with a **toggle switch** (same UI concept as Settings modal), aligned opposite the label (label left, free space, toggle in a fixed control column). Behavior and backend calls must remain unchanged.

## Scope

Frontend only.

## File

`src/features/Vault/components/modals/ExportBackupModal.tsx` 

---

## Current Behavior (must remain)

1. `useDefaultPath` state:

* Default `true`
* Resets to `true` when modal opens (`useEffect`) 

2. Destination UI is shown only when `!useDefaultPath` 
3. “Create backup” button remains disabled when `isSaving` OR when `!useDefaultPath && !destinationPath` 
4. `handleCreate()` must keep the same validation and API call:

* guard: `if (!useDefaultPath && !destinationPath) return;`
* call: `createBackup(useDefaultPath ? null : destinationPath, useDefaultPath)` 

---

## Implementation Requirements

### A) Replace checkbox with an accessible toggle switch

The switch must follow WAI-ARIA Switch pattern:

* Use a semantic `<button>` element with `role="switch"`
* Provide `aria-checked={useDefaultPath}`
* Toggle on **click**, and on **Space** (required) / **Enter** (optional) ([W3C][1])

### B) Layout requirement: “opposite the setting”

The row “Use default path … toggle” must be rendered as:

* **label** in left column
* **toggle** centered in a fixed control column (`140px`), not stuck to the right edge of the dialog

---

## Exact Code Changes

### 1) Replace the “Use default path” form-field block

**File:** `src/features/Vault/components/modals/ExportBackupModal.tsx`

Locate this block: 

```tsx
<div className="form-field">
  <label className="form-label" htmlFor="export-backup-default">
    {t('backup.export.useDefaultPath')}
  </label>
  <input
    id="export-backup-default"
    type="checkbox"
    checked={useDefaultPath}
    disabled={isSaving}
    onChange={(event) => setUseDefaultPath(event.target.checked)}
  />
</div>
```

Replace it with the following (keep it exactly):

```tsx
<div
  className="form-field"
  style={{
    display: 'grid',
    gridTemplateColumns: '1fr 140px',
    alignItems: 'center',
    columnGap: 16,
  }}
>
  <label
    className="form-label"
    id="export-backup-default-label"
    style={{ cursor: isSaving ? 'default' : 'pointer', userSelect: 'none' }}
    onClick={() => {
      if (isSaving) return;
      setUseDefaultPath((v) => !v);
    }}
  >
    {t('backup.export.useDefaultPath')}
  </label>

  <div style={{ display: 'flex', justifyContent: 'center' }}>
    <button
      id="export-backup-default-switch"
      type="button"
      role="switch"
      aria-checked={useDefaultPath}
      aria-labelledby="export-backup-default-label"
      disabled={isSaving}
      onClick={() => setUseDefaultPath((v) => !v)}
      onKeyDown={(e) => {
        if (isSaving) return;
        if (e.key === ' ' || e.key === 'Enter') {
          e.preventDefault();
          setUseDefaultPath((v) => !v);
        }
      }}
      style={{
        width: 44,
        height: 24,
        borderRadius: 9999,
        border: useDefaultPath ? '1px solid rgba(34, 197, 94, 0.95)' : '1px solid rgba(255, 255, 255, 0.25)',
        background: useDefaultPath ? 'rgba(34, 197, 94, 0.55)' : 'rgba(255, 255, 255, 0.14)',
        padding: 0,
        display: 'inline-flex',
        alignItems: 'center',
        justifyContent: 'flex-start',
        cursor: isSaving ? 'not-allowed' : 'pointer',
        opacity: isSaving ? 0.65 : 1,
        outline: 'none',
      }}
    >
      <span
        style={{
          width: 18,
          height: 18,
          borderRadius: 9999,
          background: 'rgba(255, 255, 255, 0.95)',
          transform: useDefaultPath ? 'translateX(22px)' : 'translateX(2px)',
          transition: 'transform 160ms ease',
        }}
      />
    </button>
  </div>
</div>
```

### 2) Do NOT change anything else

* Keep `handleChoosePath`, `handleCreate`, `createBackup(...)`, toast handling, conditional rendering of destination picker, and footer buttons unchanged. 

---

## Acceptance Criteria

1. “Use default path” is a toggle switch (not checkbox) and is **green when ON**.
2. Clicking the **label** also toggles the switch (unless `isSaving`).
3. Keyboard support:

* Space toggles
* Enter toggles (allowed) ([W3C][1])

4. Behavior unchanged:

* When switch is ON → destination UI hidden (`!useDefaultPath` block not rendered). 
* When switch is OFF → destination UI appears, and Create is disabled until a path is chosen. 
* `createBackup(useDefaultPath ? null : destinationPath, useDefaultPath)` remains identical. 
