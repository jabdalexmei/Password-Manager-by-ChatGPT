
## TS (patch-style, unified diff)

### 1) Frontend: типы фильтров + Search UI (popover) + применение в `visibleCards`

#### `src/features/Vault/types/searchFilters.ts` (NEW)

```diff
--- /dev/null
+++ b/src/features/Vault/types/searchFilters.ts
@@ -0,0 +1,19 @@
+export type VaultSearchFilterKey =
+  | 'has2fa'
+  | 'hasSeedPhrase'
+  | 'hasPhone'
+  | 'hasNotes'
+  | 'hasAttachments';
+
+export type VaultSearchFilters = Record<VaultSearchFilterKey, boolean>;
+
+export const defaultVaultSearchFilters: VaultSearchFilters = {
+  has2fa: false,
+  hasSeedPhrase: false,
+  hasPhone: false,
+  hasNotes: false,
+  hasAttachments: false,
+};
```

#### `src/features/Vault/components/Search/Search.tsx`

```diff
--- a/src/features/Vault/components/Search/Search.tsx
+++ b/src/features/Vault/components/Search/Search.tsx
@@ -1,20 +1,153 @@
 import React from 'react';
 import { useTranslation } from '../../../../shared/lib/i18n';
+import { IconSliders } from '../../../../shared/icons/lucide';
+import { VaultSearchFilterKey, VaultSearchFilters } from '../../types/searchFilters';
 
 type Props = {
   query: string;
   onChange: (value: string) => void;
+  filters: VaultSearchFilters;
+  onChangeFilters: (next: VaultSearchFilters) => void;
+  filterKeys: VaultSearchFilterKey[];
 };
 
-export function Search({ query, onChange }: Props) {
+export function Search({ query, onChange, filters, onChangeFilters, filterKeys }: Props) {
   const { t } = useTranslation('Vault');
+  const hasFilters = filterKeys.length > 0;
+
+  const rootRef = React.useRef<HTMLDivElement | null>(null);
+  const [open, setOpen] = React.useState(false);
+
+  // Strict UI order (as requested): 2FA -> Seed phrase -> Phone -> Notes -> Attachments
+  const desiredOrder: VaultSearchFilterKey[] = React.useMemo(
+    () => ['has2fa', 'hasSeedPhrase', 'hasPhone', 'hasNotes', 'hasAttachments'],
+    []
+  );
+
+  const orderedKeys = React.useMemo(() => {
+    const allowed = new Set(filterKeys);
+    return desiredOrder.filter((k) => allowed.has(k));
+  }, [desiredOrder, filterKeys]);
+
+  const labelFor = React.useCallback(
+    (key: VaultSearchFilterKey) => {
+      switch (key) {
+        case 'has2fa':
+          return t('filters.2fa');
+        case 'hasSeedPhrase':
+          return t('filters.seedPhrase');
+        case 'hasPhone':
+          return t('filters.phone');
+        case 'hasNotes':
+          return t('filters.notes');
+        case 'hasAttachments':
+          return t('filters.attachments');
+        default:
+          return key;
+      }
+    },
+    [t]
+  );
+
+  const toggle = React.useCallback(
+    (key: VaultSearchFilterKey) => {
+      onChangeFilters({ ...filters, [key]: !filters[key] });
+    },
+    [filters, onChangeFilters]
+  );
+
+  React.useEffect(() => {
+    if (!open) return;
+    const onPointerDown = (e: PointerEvent) => {
+      const el = rootRef.current;
+      if (!el) return;
+      if (e.target instanceof Node && !el.contains(e.target)) {
+        setOpen(false);
+      }
+    };
+    const onKeyDown = (e: KeyboardEvent) => {
+      if (e.key === 'Escape') setOpen(false);
+    };
+    document.addEventListener('pointerdown', onPointerDown);
+    document.addEventListener('keydown', onKeyDown);
+    return () => {
+      document.removeEventListener('pointerdown', onPointerDown);
+      document.removeEventListener('keydown', onKeyDown);
+    };
+  }, [open]);
 
   return (
-    <input
-      type="search"
-      className="vault-search"
-      placeholder={t('search.placeholder')}
-      value={query}
-      onChange={(e) => onChange(e.target.value)}
-    />
+    <div className="vault-search-row" ref={rootRef}>
+      <input
+        type="search"
+        className="vault-search"
+        placeholder={t('search.placeholder')}
+        value={query}
+        onChange={(e) => onChange(e.target.value)}
+      />
+
+      {hasFilters && (
+        <button
+          type="button"
+          className="vault-filter-trigger"
+          aria-label={t('filters.open')}
+          aria-haspopup="dialog"
+          aria-expanded={open}
+          onClick={() => setOpen((v) => !v)}
+        >
+          <IconSliders />
+        </button>
+      )}
+
+      {hasFilters && open && (
+        <div className="vault-filter-popover" role="dialog" aria-label={t('filters.title')}>
+          <div className="vault-filter-list">
+            {orderedKeys.map((key) => {
+              const active = !!filters[key];
+              return (
+                <button
+                  key={key}
+                  type="button"
+                  className={`vault-filter-chip${active ? ' is-active' : ''}`}
+                  aria-pressed={active}
+                  onClick={() => toggle(key)}
+                >
+                  {labelFor(key)}
+                </button>
+              );
+            })}
+          </div>
+        </div>
+      )}
+    </div>
   );
 }
```

#### `src/features/Vault/Vault.tsx`

```diff
--- a/src/features/Vault/Vault.tsx
+++ b/src/features/Vault/Vault.tsx
@@ -1,6 +1,7 @@
 import React, { useCallback, useEffect, useMemo, useState } from 'react';
 import { open } from '@tauri-apps/plugin-dialog';
 import { useVault } from './hooks/useVault';
+import { VaultSearchFilterKey } from './types/searchFilters';
 import { VaultHeader } from './components/Header/VaultHeader';
 import { Search } from './components/Search/Search';
 import { Folders } from './components/Folders/Folders';
@@ -110,6 +111,15 @@ export default function Vault({ profileId, profileName, isPasswordless, onLocked
   return (
     <div className="vault-shell">
@@ -133,10 +143,27 @@ export default function Vault({ profileId, profileName, isPasswordless, onLocked
         <aside className="vault-sidebar">
           <div className="vault-sidebar-controls">
             <Search
               query={selectedCategory === 'data_cards' ? vault.searchQuery : bankCards.searchQuery}
               onChange={selectedCategory === 'data_cards' ? vault.setSearchQuery : bankCards.setSearchQuery}
+              filters={selectedCategory === 'data_cards' ? vault.searchFilters : bankCards.searchFilters}
+              onChangeFilters={
+                selectedCategory === 'data_cards' ? vault.setSearchFilters : bankCards.setSearchFilters
+              }
+              filterKeys={
+                (selectedCategory === 'data_cards'
+                  ? (['has2fa', 'hasSeedPhrase', 'hasPhone', 'hasNotes', 'hasAttachments'] as VaultSearchFilterKey[])
+                  : (['hasNotes'] as VaultSearchFilterKey[]))
+              }
             />
           </div>
```

#### `src/features/Vault/hooks/useVault.ts`

```diff
--- a/src/features/Vault/hooks/useVault.ts
+++ b/src/features/Vault/hooks/useVault.ts
@@ -24,6 +24,7 @@ import { useDebouncedValue } from './useDebouncedValue';
 import { sortCards, sortFolders } from '../types/sort';
+import { defaultVaultSearchFilters, VaultSearchFilters } from '../types/searchFilters';
 
 export type SelectedNav = 'all' | 'favorites' | 'archive' | 'deleted' | { folderId: string };
 
@@ -43,6 +44,7 @@ export function useVault(profileId: string, onLocked: () => void) {
   const [selectedCardId, setSelectedCardId] = useState<string | null>(null);
   const [searchInput, setSearchInput] = useState('');
+  const [searchFilters, setSearchFilters] = useState<VaultSearchFilters>(defaultVaultSearchFilters);
   const debouncedSearchQuery = useDebouncedValue(searchInput, 200);
   const [loading, setLoading] = useState(false);
   const [error, setError] = useState<VaultError>(null);
@@ -59,6 +61,7 @@ export function useVault(profileId: string, onLocked: () => void) {
     setDeletedCards([]);
     setSelectedNav('all');
     setSelectedCardId(null);
+    setSearchFilters(defaultVaultSearchFilters);
     setTrashLoaded(false);
   }, [profileId]);
@@ -169,8 +172,18 @@ export function useVault(profileId: string, onLocked: () => void) {
   const loadCard = useCallback(
     async (id: string) => {
       try {
+        const existingSummary =
+          cards.find((c) => c.id === id) ?? deletedCards.find((c) => c.id === id) ?? null;
         const card = await getDataCard(id);
         const mapped = mapCardFromBackend(card);
-        const summary = mapCardToSummary(mapped, dtf);
+        const summary = {
+          ...mapCardToSummary(mapped, dtf),
+          // attachments are not part of full card payload; preserve summary flag if we had it
+          hasAttachments: existingSummary?.hasAttachments ?? false,
+        };
 
         setCardDetailsById((prev) => ({ ...prev, [id]: mapped }));
@@ -313,6 +326,7 @@ export function useVault(profileId: string, onLocked: () => void) {
   const uploadAttachments = useCallback(
     async (cardId: string, paths: string[]) => {
       const failed: string[] = [];
+      let uploadedAny = false;
       for (const path of paths) {
         try {
           await addAttachmentFromPath(cardId, path);
+          uploadedAny = true;
         } catch (err) {
           failed.push(path);
           handleError(err);
         }
       }
+
+      if (uploadedAny) {
+        setCards((prev) => prev.map((c) => (c.id === cardId ? { ...c, hasAttachments: true } : c)));
+        setDeletedCards((prev) => prev.map((c) => (c.id === cardId ? { ...c, hasAttachments: true } : c)));
+      }
 
       return failed;
     },
     [handleError]
   );
@@ -361,11 +375,15 @@ export function useVault(profileId: string, onLocked: () => void) {
   const deleteCardAction = useCallback(
     async (id: string) => {
       try {
         await deleteDataCard(id);
         const softDeleteEnabled = settings?.soft_delete_enabled ?? true;
-        const cachedSummary = cardDetailsById[id]
-          ? mapCardToSummary(cardDetailsById[id], dtf)
-          : cards.find((card) => card.id === id) || deletedCards.find((card) => card.id === id);
+        // Prefer existing summary (it includes flags like hasAttachments); only fallback to mapping full card.
+        const cachedSummary =
+          cards.find((card) => card.id === id) ||
+          deletedCards.find((card) => card.id === id) ||
+          (cardDetailsById[id] ? mapCardToSummary(cardDetailsById[id], dtf) : null);
@@ -542,6 +560,29 @@ export function useVault(profileId: string, onLocked: () => void) {
   const visibleCards = useMemo(() => {
@@ -561,6 +602,23 @@ export function useVault(profileId: string, onLocked: () => void) {
       pool = activeCards.filter((card) => card.folderId === selectedNav.folderId && !isArchived(card));
     }
 
+    // Apply UI filters (no DB writes)
+    if (searchFilters.has2fa) pool = pool.filter((c) => c.hasTotp);
+    if (searchFilters.hasSeedPhrase) pool = pool.filter((c) => c.hasSeedPhrase);
+    if (searchFilters.hasPhone) pool = pool.filter((c) => c.hasPhone);
+    if (searchFilters.hasNotes) pool = pool.filter((c) => c.hasNotes);
+    if (searchFilters.hasAttachments) pool = pool.filter((c) => c.hasAttachments);
+
     if (!debouncedSearchQuery.trim()) return pool;
@@ -575,7 +633,7 @@ export function useVault(profileId: string, onLocked: () => void) {
       return fields.some((field) => field && field.toLowerCase().includes(query));
     });
-  }, [cards, debouncedSearchQuery, deletedCards, selectedNav]);
+  }, [cards, debouncedSearchQuery, deletedCards, searchFilters, selectedNav]);
@@ -648,6 +706,8 @@ export function useVault(profileId: string, onLocked: () => void) {
     setSearchQuery: setSearchInput,
+    searchFilters,
+    setSearchFilters,
     visibleCards,
     selectedCard,
     selectCard,
```

#### `src/features/Vault/hooks/useBankCards.ts`

```diff
--- a/src/features/Vault/hooks/useBankCards.ts
+++ b/src/features/Vault/hooks/useBankCards.ts
@@ -18,6 +18,7 @@ import { useDebouncedValue } from './useDebouncedValue';
 import { sortBankCards } from '../types/sort';
+import { defaultVaultSearchFilters, VaultSearchFilters } from '../types/searchFilters';
 
 export type SelectedBankNav = 'all' | 'favorites' | 'archive' | 'deleted';
@@ -33,6 +34,7 @@ export function useBankCards(profileId: string, onLocked: () => void) {
   const [selectedCardId, setSelectedCardId] = useState<string | null>(null);
   const [searchInput, setSearchInput] = useState('');
+  const [searchFilters, setSearchFilters] = useState<VaultSearchFilters>(defaultVaultSearchFilters);
   const debouncedSearchQuery = useDebouncedValue(searchInput, 200);
@@ -49,6 +51,7 @@ export function useBankCards(profileId: string, onLocked: () => void) {
     setCards([]);
     setCardDetailsById({});
     setDeletedCards([]);
     setSelectedNav('all');
     setSelectedCardId(null);
+    setSearchFilters(defaultVaultSearchFilters);
     setTrashLoaded(false);
   }, [profileId]);
@@ -318,6 +328,10 @@ export function useBankCards(profileId: string, onLocked: () => void) {
     } else {
       pool = activeCards;
     }
 
+    // Bank cards: only "Notes" filter is used in UI (others ignored)
+    if (searchFilters.hasNotes) pool = pool.filter((c) => c.hasNotes);
+
     if (!debouncedSearchQuery.trim()) return pool;
@@ -331,7 +345,7 @@ export function useBankCards(profileId: string, onLocked: () => void) {
       return fields.some((field) => field && field.toLowerCase().includes(query));
     });
-  }, [cards, debouncedSearchQuery, deletedCards, selectedNav]);
+  }, [cards, debouncedSearchQuery, deletedCards, searchFilters, selectedNav]);
@@ -412,6 +426,8 @@ export function useBankCards(profileId: string, onLocked: () => void) {
     setSearchQuery: setSearchInput,
+    searchFilters,
+    setSearchFilters,
     visibleCards,
     selectedCard,
     selectCard,
```

---

### 2) Frontend: расширяем summary-типы (флаги) + мапперы

#### `src/features/Vault/types/backend.ts`

```diff
--- a/src/features/Vault/types/backend.ts
+++ b/src/features/Vault/types/backend.ts
@@ -46,6 +46,10 @@ export type BackendDataCardSummary = {
   updated_at: string;
   deleted_at: string | null;
   is_favorite: boolean;
   has_totp: boolean;
+  has_seed_phrase: boolean;
+  has_phone: boolean;
+  has_note: boolean;
+  has_attachments: boolean;
 };
@@ -87,6 +91,7 @@ export type BackendBankCardSummary = {
   created_at: string;
   updated_at: string;
   deleted_at: string | null;
+  has_note: boolean;
 };
```

#### `src/features/Vault/types/ui.ts`

```diff
--- a/src/features/Vault/types/ui.ts
+++ b/src/features/Vault/types/ui.ts
@@ -55,6 +55,10 @@ export type DataCardSummary = DataCard & {
   createdAtLabel: string;
   metaLine: string;
   hasTotp: boolean;
+  hasSeedPhrase: boolean;
+  hasPhone: boolean;
+  hasNotes: boolean;
+  hasAttachments: boolean;
 };
@@ -108,6 +112,7 @@ export type BankCardSummary = BankCardItem & {
   updatedAtLabel: string;
   createdAtLabel: string;
   metaLine: string;
+  hasNotes: boolean;
 };
```

#### `src/features/Vault/types/mappers.ts`

```diff
--- a/src/features/Vault/types/mappers.ts
+++ b/src/features/Vault/types/mappers.ts
@@ -74,6 +74,10 @@ export function mapCardSummaryFromBackend(
     isFavorite: card.is_favorite,
     hasTotp: card.has_totp,
+    hasSeedPhrase: card.has_seed_phrase,
+    hasPhone: card.has_phone,
+    hasNotes: card.has_note,
+    hasAttachments: card.has_attachments,
     updatedAtLabel,
     createdAtLabel,
     metaLine: metaFromCard(card, ''),
   };
 }
 
 export function mapCardToSummary(card: DataCard, formatter: Intl.DateTimeFormat): DataCardSummary {
@@ -89,10 +93,18 @@ export function mapCardToSummary(card: DataCard, formatter: Intl.DateTimeFormat): DataCardSummary {
   return {
     ...card,
     updatedAtLabel,
     createdAtLabel,
     metaLine: metaFromCard(card, ''),
     hasTotp: (card.totpUri ?? null) !== null,
+    hasSeedPhrase: (card.seedPhrase ?? null) !== null,
+    hasPhone: (card.mobilePhone ?? null) !== null,
+    hasNotes: (card.note ?? null) !== null,
+    // attachments are not part of DataCard payload; this gets preserved in useVault.loadCard()
+    hasAttachments: false,
   };
 }
@@ -150,6 +162,7 @@ export function mapBankCardSummaryFromBackend(
     deletedAt: card.deleted_at,
     updatedAtLabel,
     createdAtLabel,
     metaLine,
+    hasNotes: card.has_note,
   };
 }
 
 export function mapBankCardToSummary(card: BankCardItem, formatter: Intl.DateTimeFormat): BankCardSummary {
@@ -163,6 +176,7 @@ export function mapBankCardToSummary(card: BankCardItem, formatter: Intl.DateTimeFormat): BankCardSummary {
   return {
     ...card,
     updatedAtLabel,
     createdAtLabel,
     metaLine,
+    hasNotes: (card.note ?? null) !== null,
   };
 }
```

---

### 3) UI: иконка Sliders + стили (маленькие chip-кнопки, колонка, popover не вылезает)

#### `src/shared/icons/lucide/icons.ts`

```diff
--- a/src/shared/icons/lucide/icons.ts
+++ b/src/shared/icons/lucide/icons.ts
@@ -1,6 +1,7 @@
 // Centralized semantic icon mapping.
 // Only this file should import directly from "lucide-react".
 export {
+  SlidersHorizontal as IconSliders,
   Eye as IconPreview,
   EyeOff as IconPreviewOff,
@@ -24,6 +25,7 @@ export {
   History as IconHistory,
 } from "lucide-react";
```

#### `src/shared/styles/screens/vault.css`

```diff
--- a/src/shared/styles/screens/vault.css
+++ b/src/shared/styles/screens/vault.css
@@ -60,12 +60,78 @@
 .vault-sidebar-controls {
   display: flex;
   flex-direction: column;
   gap: 10px;
   margin-bottom: 14px;
 }
 
+.vault-search-row {
+  position: relative;
+  display: flex;
+  gap: 8px;
+  align-items: stretch;
+}
+
 .vault-search {
   width: 100%;
+  flex: 1;
+  min-width: 0;
   padding: 12px 12px;
   border-radius: var(--radius-md);
   border: 1px solid var(--color-border);
   background: var(--color-input-bg);
   color: var(--color-text);
 }
 
+.vault-filter-trigger {
+  width: 44px;
+  height: 44px;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+  border-radius: var(--radius-md);
+  border: 1px solid var(--color-border);
+  background: var(--color-surface-1);
+  color: var(--color-text);
+  cursor: pointer;
+}
+
+.vault-filter-trigger:hover {
+  background: var(--color-surface-2);
+  border-color: var(--focus-border);
+}
+
+.vault-filter-trigger:focus-visible {
+  outline: var(--focus-ring);
+  outline-offset: var(--focus-ring-offset);
+}
+
+.vault-filter-trigger svg {
+  width: 18px;
+  height: 18px;
+}
+
+.vault-filter-popover {
+  position: absolute;
+  top: calc(100% + 8px);
+  left: 0;
+  right: 0;
+  z-index: 40;
+  background: var(--color-surface-2);
+  border: 1px solid var(--color-border);
+  border-radius: var(--radius-md);
+  box-shadow: var(--shadow-popover);
+  overflow: hidden;
+  max-height: calc(100vh - 240px);
+}
+
+.vault-filter-list {
+  display: flex;
+  flex-direction: column;
+  gap: 6px;
+  padding: 10px;
+  overflow-y: auto;
+}
+
+/* Chip toggles (NOT .btn) — compact, predictable sizing */
+.vault-filter-chip {
+  width: 100%;
+  height: 28px;
+  padding: 0 10px;
+  border-radius: var(--radius-sm);
+  border: 1px solid var(--color-border);
+  background: var(--color-surface-1);
+  color: var(--color-text);
+  font-size: 12px;
+  line-height: 1;
+  display: inline-flex;
+  align-items: center;
+  justify-content: flex-start;
+  cursor: pointer;
+  user-select: none;
+}
+
+.vault-filter-chip:hover {
+  background: var(--color-surface-2);
+  border-color: var(--focus-border);
+}
+
+.vault-filter-chip:focus-visible {
+  outline: var(--focus-ring);
+  outline-offset: var(--focus-ring-offset);
+}
+
+.vault-filter-chip.is-active {
+  background: var(--color-primary);
+  border-color: var(--color-primary);
+  color: var(--color-on-primary);
+}
+
 .vault-search:focus-visible {
   outline: 2px solid var(--color-primary);
   border-color: transparent;
 }
```

---

### 4) i18n: подписи фильтров

#### `src/i18n/locales/en/Vault.json`

```diff
--- a/src/i18n/locales/en/Vault.json
+++ b/src/i18n/locales/en/Vault.json
@@ -8,6 +8,13 @@
   "logout": "Log out",
   "search.placeholder": "Search",
+  "filters.title": "Filters",
+  "filters.open": "Filters",
+  "filters.2fa": "2FA",
+  "filters.seedPhrase": "Seed phrase",
+  "filters.phone": "Phone",
+  "filters.notes": "Notes",
+  "filters.attachments": "Attachments",
   "nav.all_items": "All items",
   "nav.favorites": "Favorites",
   "nav.archive": "Archive",
```

---

## 5) Backend (Rust): добавляем флаги в summary без миграций

### `src-tauri/src/types.rs`

```diff
--- a/src-tauri/src/types.rs
+++ b/src-tauri/src/types.rs
@@ -70,6 +70,10 @@ pub struct DataCardSummary {
     pub updated_at: String,
     pub deleted_at: Option<String>,
     pub is_favorite: bool,
     pub has_totp: bool,
+    pub has_seed_phrase: bool,
+    pub has_phone: bool,
+    pub has_note: bool,
+    pub has_attachments: bool,
 }
@@ -121,6 +125,7 @@ pub struct BankCardSummary {
     pub created_at: String,
     pub updated_at: String,
     pub deleted_at: Option<String>,
+    pub has_note: bool,
 }
```

### `src-tauri/src/data/sqlite/repo_impl.rs`

```diff
--- a/src-tauri/src/data/sqlite/repo_impl.rs
+++ b/src-tauri/src/data/sqlite/repo_impl.rs
@@ -88,6 +88,10 @@ fn map_datacard_summary(row: &rusqlite::Row) -> rusqlite::Result<DataCardSummary> {
     let tags: Vec<String> = deserialize_json(row.get::<_, String>("tags_json")?)?;
     let is_favorite = row.get::<_, i64>("is_favorite")? != 0;
     let has_totp = row.get::<_, Option<String>>("totp_uri")?.is_some();
+    let has_seed_phrase = row.get::<_, i64>("has_seed_phrase")? != 0;
+    let has_phone = row.get::<_, i64>("has_phone")? != 0;
+    let has_note = row.get::<_, i64>("has_note")? != 0;
+    let has_attachments = row.get::<_, i64>("has_attachments")? != 0;
 
     Ok(DataCardSummary {
         id: row.get("id")?,
@@ -105,6 +109,10 @@ fn map_datacard_summary(row: &rusqlite::Row) -> rusqlite::Result<DataCardSummary> {
         deleted_at: row.get("deleted_at")?,
         is_favorite,
         has_totp,
+        has_seed_phrase,
+        has_phone,
+        has_note,
+        has_attachments,
     })
 }
@@ -127,12 +135,15 @@ fn map_bank_card_summary(row: &rusqlite::Row) -> rusqlite::Result<BankCardSummary> {
     let tags: Vec<String> = deserialize_json(row.get::<_, String>("tags_json")?)?;
     let is_favorite = row.get::<_, i64>("is_favorite")? != 0;
+    let has_note = row.get::<_, i64>("has_note")? != 0;
 
     Ok(BankCardSummary {
         id: row.get("id")?,
         title: row.get("title")?,
         holder: row.get("holder")?,
         number: row.get("number")?,
         tags,
         is_favorite,
         created_at: row.get("created_at")?,
         updated_at: row.get("updated_at")?,
         deleted_at: row.get("deleted_at")?,
+        has_note,
     })
 }
@@ -360,9 +371,22 @@ pub fn list_datacards_summary(
     with_connection(state, profile_id, |conn| {
         let clause = order_clause(sort_field, sort_dir)
             .ok_or_else(|| ErrorCodeString::new("DB_QUERY_FAILED"))?;
         let query = format!(
-            "SELECT id, folder_id, title, url, email, username, totp_uri, tags_json, is_favorite, created_at, updated_at, deleted_at FROM datacards WHERE deleted_at IS NULL {clause}"
+            "SELECT
+              d.id, d.folder_id, d.title, d.url, d.email, d.username,
+              d.totp_uri, d.tags_json, d.is_favorite, d.created_at, d.updated_at, d.deleted_at,
+              CASE WHEN d.seed_phrase_value IS NOT NULL AND TRIM(d.seed_phrase_value) <> '' THEN 1 ELSE 0 END AS has_seed_phrase,
+              CASE WHEN d.mobile_phone IS NOT NULL AND TRIM(d.mobile_phone) <> '' THEN 1 ELSE 0 END AS has_phone,
+              CASE WHEN d.note IS NOT NULL AND TRIM(d.note) <> '' THEN 1 ELSE 0 END AS has_note,
+              CASE WHEN EXISTS(
+                SELECT 1 FROM attachments a WHERE a.datacard_id = d.id AND a.deleted_at IS NULL
+              ) THEN 1 ELSE 0 END AS has_attachments
+            FROM datacards d
+            WHERE d.deleted_at IS NULL {clause}"
         );
         let mut stmt = conn.prepare(&query).map_err(|e| {
             log_sqlite_err("list_datacards_summary.prepare", &query, &e);
             ErrorCodeString::new("DB_QUERY_FAILED")
         })?;
@@ -418,7 +442,22 @@ pub fn list_deleted_datacards_summary(
     with_connection(state, profile_id, |conn| {
         let mut stmt = conn
             .prepare(
-                "SELECT id, folder_id, title, url, email, username, totp_uri, tags_json, is_favorite, created_at, updated_at, deleted_at FROM datacards WHERE deleted_at IS NOT NULL ORDER BY deleted_at DESC",
+                "SELECT
+                  d.id, d.folder_id, d.title, d.url, d.email, d.username,
+                  d.totp_uri, d.tags_json, d.is_favorite, d.created_at, d.updated_at, d.deleted_at,
+                  CASE WHEN d.seed_phrase_value IS NOT NULL AND TRIM(d.seed_phrase_value) <> '' THEN 1 ELSE 0 END AS has_seed_phrase,
+                  CASE WHEN d.mobile_phone IS NOT NULL AND TRIM(d.mobile_phone) <> '' THEN 1 ELSE 0 END AS has_phone,
+                  CASE WHEN d.note IS NOT NULL AND TRIM(d.note) <> '' THEN 1 ELSE 0 END AS has_note,
+                  CASE WHEN EXISTS(
+                    SELECT 1 FROM attachments a WHERE a.datacard_id = d.id AND a.deleted_at IS NULL
+                  ) THEN 1 ELSE 0 END AS has_attachments
+                FROM datacards d
+                WHERE d.deleted_at IS NOT NULL
+                ORDER BY d.deleted_at DESC",
             )
             .map_err(|_| ErrorCodeString::new("DB_QUERY_FAILED"))?;
@@ -694,9 +733,13 @@ pub fn list_bank_cards_summary(
     with_connection(state, profile_id, |conn| {
         let clause = order_clause(sort_field, sort_dir).unwrap_or("ORDER BY updated_at DESC");
         let query = format!(
-            "SELECT id, title, holder, number, tags_json, is_favorite, created_at, updated_at, deleted_at FROM bank_cards WHERE deleted_at IS NULL {clause}"
+            "SELECT
+              id, title, holder, number, tags_json, is_favorite, created_at, updated_at, deleted_at,
+              CASE WHEN note IS NOT NULL AND TRIM(note) <> '' THEN 1 ELSE 0 END AS has_note
+            FROM bank_cards WHERE deleted_at IS NULL {clause}"
         );
         let mut stmt = conn.prepare(&query).map_err(|e| {
             log_sqlite_err("list_bank_cards_summary.prepare", &query, &e);
             ErrorCodeString::new("DB_QUERY_FAILED")
         })?;
@@ -726,7 +769,12 @@ pub fn list_deleted_bank_cards_summary(
     with_connection(state, profile_id, |conn| {
         let mut stmt = conn
             .prepare(
-                "SELECT id, title, holder, number, tags_json, is_favorite, created_at, updated_at, deleted_at FROM bank_cards WHERE deleted_at IS NOT NULL ORDER BY deleted_at DESC",
+                "SELECT
+                  id, title, holder, number, tags_json, is_favorite, created_at, updated_at, deleted_at,
+                  CASE WHEN note IS NOT NULL AND TRIM(note) <> '' THEN 1 ELSE 0 END AS has_note
+                FROM bank_cards WHERE deleted_at IS NOT NULL ORDER BY deleted_at DESC",
             )
             .map_err(|_| ErrorCodeString::new("DB_QUERY_FAILED"))?;
```



[1]: https://www.w3.org/WAI/ARIA/apg/patterns/button/?utm_source=chatgpt.com "Button Pattern | APG | WAI"
[2]: https://www.w3.org/WAI/WCAG22/Understanding/target-size-minimum.html?utm_source=chatgpt.com "Understanding SC 2.5.8: Target Size (Minimum) (Level AA)"
