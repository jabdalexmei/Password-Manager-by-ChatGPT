

## TS (diff-like)

### 1) Fix word count (“12 words” instead of “1 words”) + hide “Edit fields” when only seed phrase exists

#### File: `src/features/Vault/components/DataCards/DataCards.tsx`

**Purpose:** Treat seed phrase fields as reserved (not custom fields), store word count separately, and render correct summary count.

```diff
--- src/features/Vault/components/DataCards/DataCards.tsx (before)
+++ src/features/Vault/components/DataCards/DataCards.tsx (after)
@@
 import { Add2FAModal } from '../modals/Add2FAModal';
+import { SeedPhraseModal } from '../modals/SeedPhraseModal';
@@
 export function DataCards({
@@
 }: DataCardsProps) {
   const { t } = useTranslation('DataCards');
@@
+  const SEED_PHRASE_FIELD_KEY = 'Seed phrase';
+  const SEED_PHRASE_COUNT_KEY = '__seed_phrase_count';
@@
   const [is2faModalOpen, setIs2faModalOpen] = useState(false);
@@
+  const [isSeedPhraseModalOpen, setIsSeedPhraseModalOpen] = useState(false);
+  const [seedPhraseTargetDialogId, setSeedPhraseTargetDialogId] = useState<
+    'datacard-create-dialog' | 'datacard-edit-dialog' | null
+  >(null);
@@
   useEffect(() => {
     if (isCreateOpen || isEditOpen) return;
@@
     setIs2faModalOpen(false);
     setTwoFactorTargetDialogId(null);
+    setIsSeedPhraseModalOpen(false);
+    setSeedPhraseTargetDialogId(null);
   }, [isCreateOpen, isEditOpen]);
@@
     const isCreateDialog = dialogId === 'datacard-create-dialog';
+
+    const seedPhraseRow = form.customFields.find(
+      (row) => row.key.trim().toLowerCase() === SEED_PHRASE_FIELD_KEY.toLowerCase()
+    );
+    const seedPhraseCountRow = form.customFields.find(
+      (row) => row.key.trim().toLowerCase() === SEED_PHRASE_COUNT_KEY.toLowerCase()
+    );
+
+    const seedPhraseCount =
+      (seedPhraseCountRow?.value ? Number(seedPhraseCountRow.value) : 0) ||
+      (seedPhraseRow?.value
+        ? seedPhraseRow.value
+            .trim()
+            .split(/\s+/)
+            .filter(Boolean).length
+        : 0);
+
+    const visibleCustomFields = form.customFields.filter((row) => {
+      const k = row.key.trim().toLowerCase();
+      return k !== SEED_PHRASE_FIELD_KEY.toLowerCase() && k !== SEED_PHRASE_COUNT_KEY.toLowerCase();
+    });
@@
-                  {(form?.customFields?.length ?? 0) > 0 && (
+                  {visibleCustomFields.length > 0 && (
                     <button
                       type="button"
                       className="dialog-actionmenu-item"
                       onClick={() => {
                         setIsActionMenuOpen(false);
                         setIsEditFieldsMode((prev) => !prev);
                       }}
                     >
                       {t('customFields.editFields')}
                     </button>
                   )}
                 </div>
               )}
@@
-            {form.customFields.map((row) => (
+            {seedPhraseCount > 0 && (
+              <div className="form-field">
+                <label className="form-label">{t('seedPhrase.title')}</label>
+                <div
+                  className="seedphrase-summary"
+                  role="button"
+                  tabIndex={0}
+                  onClick={() => {
+                    setSeedPhraseTargetDialogId(dialogId as 'datacard-create-dialog' | 'datacard-edit-dialog');
+                    setIsSeedPhraseModalOpen(true);
+                  }}
+                  onKeyDown={(e) => {
+                    if (e.key === 'Enter' || e.key === ' ') {
+                      e.preventDefault();
+                      setSeedPhraseTargetDialogId(dialogId as 'datacard-create-dialog' | 'datacard-edit-dialog');
+                      setIsSeedPhraseModalOpen(true);
+                    }
+                  }}
+                >
+                  <span className="seedphrase-summary-count">{t('seedPhrase.wordsCount', { count: seedPhraseCount })}</span>
+                  <span className="muted">{t('seedPhrase.editAction')}</span>
+                </div>
+              </div>
+            )}
+
+            {visibleCustomFields.map((row) => (
               <div className="form-field" key={row.id}>
                 <label className="form-label" htmlFor={`${dialogId}-cf-${row.id}`}>
                   {row.key}
                 </label>
@@
             ))}
@@
       <Add2FAModal
@@
       />
+
+      <SeedPhraseModal
+        isOpen={isSeedPhraseModalOpen}
+        existingPhrase={
+          seedPhraseTargetDialogId === 'datacard-create-dialog'
+            ? (viewModel.createForm.customFields.find(
+                (row) => row.key.trim().toLowerCase() === SEED_PHRASE_FIELD_KEY.toLowerCase()
+              )?.value ?? null)
+            : (viewModel.editForm?.customFields.find(
+                (row) => row.key.trim().toLowerCase() === SEED_PHRASE_FIELD_KEY.toLowerCase()
+              )?.value ?? null)
+        }
+        onCancel={() => {
+          setIsSeedPhraseModalOpen(false);
+          setSeedPhraseTargetDialogId(null);
+        }}
+        onSave={(words, wordCount) => {
+          const phrase = words.join(' ').trim();
+
+          if (seedPhraseTargetDialogId === 'datacard-create-dialog') {
+            viewModel.setCreateCustomFieldByKey(SEED_PHRASE_FIELD_KEY, phrase, 'secret');
+            viewModel.setCreateCustomFieldByKey(SEED_PHRASE_COUNT_KEY, String(wordCount), 'text');
+          } else {
+            viewModel.setEditCustomFieldByKey(SEED_PHRASE_FIELD_KEY, phrase, 'secret');
+            viewModel.setEditCustomFieldByKey(SEED_PHRASE_COUNT_KEY, String(wordCount), 'text');
+          }
+
+          setIsSeedPhraseModalOpen(false);
+          setSeedPhraseTargetDialogId(null);
+        }}
+      />
     </div>
   );
 }
```

---

### 2) Make dropdown fully themed (remove native `<select>`)

#### File: `src/features/Vault/components/modals/SeedPhraseModal.tsx`

**Purpose:** Replace native `<select>` with a custom single-select listbox (button + dropdown) so it never shows white OS dropdown.

```diff
--- src/features/Vault/components/modals/SeedPhraseModal.tsx (before)
+++ src/features/Vault/components/modals/SeedPhraseModal.tsx (after)
@@
-import React, { useEffect, useMemo, useState } from 'react';
+import React, { useEffect, useMemo, useRef, useState } from 'react';
 import { useTranslation } from '../../../../shared/lib/i18n';
@@
 type WordCount = 12 | 18 | 24;
@@
 type SeedPhraseModalProps = {
   isOpen: boolean;
   existingPhrase: string | null;
   onCancel: () => void;
-  onSave: (words: string[]) => void;
+  onSave: (words: string[], wordCount: WordCount) => void;
 };
@@
 export const SeedPhraseModal: React.FC<SeedPhraseModalProps> = ({
@@
 }) => {
   const { t } = useTranslation('DataCards');
@@
   const [wordCount, setWordCount] = useState<WordCount>(12);
   const [words, setWords] = useState<string[]>(Array.from({ length: 12 }, () => ''));
   const [error, setError] = useState<string | null>(null);
+
+  const [isCountMenuOpen, setIsCountMenuOpen] = useState(false);
+  const countButtonRef = useRef<HTMLButtonElement | null>(null);
+  const countMenuRef = useRef<HTMLDivElement | null>(null);
@@
   if (!isOpen) return null;
@@
   const handleChangeCount = (next: WordCount) => {
     setWordCount(next);
@@
     setError(null);
   };
+
+  useEffect(() => {
+    if (!isCountMenuOpen) return;
+
+    const onMouseDown = (e: MouseEvent) => {
+      const target = e.target as Node | null;
+      if (!target) return;
+      if (countMenuRef.current?.contains(target)) return;
+      if (countButtonRef.current?.contains(target)) return;
+      setIsCountMenuOpen(false);
+    };
+
+    const onKeyDown = (e: KeyboardEvent) => {
+      if (e.key === 'Escape') setIsCountMenuOpen(false);
+    };
+
+    window.addEventListener('mousedown', onMouseDown);
+    window.addEventListener('keydown', onKeyDown);
+    return () => {
+      window.removeEventListener('mousedown', onMouseDown);
+      window.removeEventListener('keydown', onKeyDown);
+    };
+  }, [isCountMenuOpen]);
@@
   const handleSave = () => {
@@
-    onSave(words.map((w) => w.trim()));
+    onSave(words.map((w) => w.trim()), wordCount);
   };
@@
           <div className="form-field">
             <label className="form-label" htmlFor="seedphrase-count">
               {t('seedPhrase.wordCount')}
             </label>
-            <select
-              id="seedphrase-count"
-              className="input"
-              value={wordCount}
-              onChange={(e) => handleChangeCount(Number(e.target.value) as WordCount)}
-            >
-              <option value={12}>{t('seedPhrase.words12')}</option>
-              <option value={18}>{t('seedPhrase.words18')}</option>
-              <option value={24}>{t('seedPhrase.words24')}</option>
-            </select>
+            <div className="seedphrase-select">
+              <button
+                ref={countButtonRef}
+                id="seedphrase-count"
+                type="button"
+                className="seedphrase-select__button"
+                aria-haspopup="listbox"
+                aria-expanded={isCountMenuOpen}
+                onClick={() => setIsCountMenuOpen((v) => !v)}
+              >
+                <span>
+                  {wordCount === 12 ? t('seedPhrase.words12') : wordCount === 18 ? t('seedPhrase.words18') : t('seedPhrase.words24')}
+                </span>
+                <span className="seedphrase-select__chevron" aria-hidden="true">▾</span>
+              </button>
+
+              {isCountMenuOpen && (
+                <div ref={countMenuRef} className="seedphrase-select__menu" role="listbox" aria-labelledby="seedphrase-count">
+                  {WORD_COUNTS.map((c) => (
+                    <button
+                      key={c}
+                      type="button"
+                      role="option"
+                      aria-selected={c === wordCount}
+                      className={`seedphrase-select__option ${c === wordCount ? 'is-selected' : ''}`}
+                      onClick={() => {
+                        handleChangeCount(c);
+                        setIsCountMenuOpen(false);
+                      }}
+                    >
+                      {c === 12 ? t('seedPhrase.words12') : c === 18 ? t('seedPhrase.words18') : t('seedPhrase.words24')}
+                    </button>
+                  ))}
+                </div>
+              )}
+            </div>
           </div>
```

---

### 3) Styles for custom dropdown (no white) + small UX polish

#### File: `src/shared/styles/ui.css`

**Purpose:** Provide dark-themed dropdown and keep it consistent with the app tokens.

```diff
--- src/shared/styles/ui.css
+++ src/shared/styles/ui.css
@@
 .seedphrase-dialog {
   width: min(720px, calc(100vw - 40px));
 }
@@
 .seedphrase-summary {
@@
 }
+
+.seedphrase-select {
+  position: relative;
+}
+
+.seedphrase-select__button {
+  width: 100%;
+  display: flex;
+  align-items: center;
+  justify-content: space-between;
+  gap: 10px;
+  padding: 10px 12px;
+  border-radius: var(--radius-md);
+  border: 1px solid var(--border-subtle);
+  background: var(--color-surface-2);
+  color: var(--color-text);
+}
+
+.seedphrase-select__button:focus {
+  outline: none;
+  box-shadow: 0 0 0 3px var(--focus-ring);
+  border-color: transparent;
+}
+
+.seedphrase-select__chevron {
+  opacity: 0.8;
+}
+
+.seedphrase-select__menu {
+  position: absolute;
+  left: 0;
+  right: 0;
+  top: calc(100% + 6px);
+  z-index: 50;
+  border-radius: var(--radius-md);
+  border: 1px solid var(--border-subtle);
+  background: var(--color-surface-1);
+  box-shadow: var(--shadow-lg);
+  overflow: hidden;
+}
+
+.seedphrase-select__option {
+  width: 100%;
+  text-align: left;
+  padding: 10px 12px;
+  background: transparent;
+  color: var(--color-text);
+  border: 0;
+}
+
+.seedphrase-select__option:hover {
+  background: var(--surface-tint-02);
+}
+
+.seedphrase-select__option.is-selected {
+  background: var(--surface-tint-03);
+}
```

---

### 4) Text fixes (“12 words”, “Edit seed phrase”)

#### File: `src/i18n/locales/en/DataCards.json`

**Purpose:** Fix summary labels and make UI wording correct.

```diff
--- src/i18n/locales/en/DataCards.json
+++ src/i18n/locales/en/DataCards.json
@@
   "seedPhrase": {
     "addAction": "Add seed phrase",
+    "editAction": "Edit seed phrase",
     "title": "Seed phrase",
     "wordCount": "Word count",
     "words12": "12 words",
     "words18": "18 words",
     "words24": "24 words",
     "gridAria": "Seed phrase words",
-    "errorIncomplete": "Please fill all words"
+    "errorIncomplete": "Please fill all words",
+    "wordsCount": "{{count}} words"
   },
```

---


