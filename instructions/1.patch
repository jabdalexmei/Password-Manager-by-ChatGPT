--- a/src-tauri/src/services/security_service.rs
+++ b/src-tauri/src/services/security_service.rs
@@ -262,6 +262,27 @@
     file_has_prefix(path, MAGIC)
 }
 
+fn dir_contains_encrypted_attachments(dir: &Path) -> io::Result<bool> {
+    for entry in std::fs::read_dir(dir)? {
+        let entry = entry?;
+        let path = entry.path();
+        if !path.is_file() {
+            continue;
+        }
+        let file_name = match path.file_name().and_then(|n| n.to_str()) {
+            Some(n) => n,
+            None => continue,
+        };
+        if !file_name.ends_with(".bin") {
+            continue;
+        }
+        if file_has_prefix(&path, &cipher::PM_ENC_MAGIC) {
+            return Ok(true);
+        }
+    }
+    Ok(false)
+}
+
 fn prepare_transition_backup_root(
     backup_root: &Path,
     storage_paths: &crate::data::storage_paths::StoragePaths,
@@ -657,8 +678,25 @@
     let has_salt = salt_path.exists();
     let has_key = key_path.exists();
 
-    // If vault is plaintext and no protected materials exist, prefer completing the transition.
+
+    // If vault is plaintext and no protected materials exist, prefer completing the transition,
+    // BUT only if attachments are already plaintext OR we have staging/backup evidence.
+    // remove_profile_password writes the plaintext vault before migrating attachments; a crash in-between
+    // must roll back to protected (otherwise encrypted attachments would remain under a passwordless profile).
     if vault_is_plain && !has_salt && !has_key {
+        let attachments_already_plain = if attachments_dir.exists() {
+            !dir_contains_encrypted_attachments(&attachments_dir)
+                .map_err(|_| ErrorCodeString::new("PROFILE_STORAGE_WRITE"))?
+        } else {
+            // If the attachments directory is missing but an encrypted backup exists,
+            // we cannot consider the transition complete.
+            !attachments_encrypted_backup_dir.exists()
+        };
+
+        if attachments_plain_staging_dir.exists()
+            || attachments_encrypted_backup_dir.exists()
+            || attachments_already_plain
+        {
         if attachments_plain_staging_dir.exists() {
             // Complete attachments swap if needed.
             if attachments_dir.exists() {
@@ -708,6 +746,7 @@
         clear_pool(profile_id);
         let _ = std::fs::remove_dir_all(backup_root);
         return Ok(());
+        }
     }
 
     // Otherwise, rollback back to protected.
