*** Begin Patch
*** Update File: src-tauri/src/data/profiles/paths.rs
@@ #[cfg(windows)]
-fn set_dir_private(path: &Path) -> std::io::Result<()> {
-    use std::ffi::OsString;
-    use std::process::Command;
+fn set_dir_private(path: &Path) -> std::io::Result<()> {
+    use std::ffi::OsString;
+    use std::process::{Command, Stdio};
+    // On Windows, hide any console window when invoking external commands.
+    // `creation_flags(0x08000000)` sets CREATE_NO_WINDOW so that icacls.exe
+    // doesn't steal focus or flash a console. See
+    // https://learn.microsoft.com/en-us/windows/win32/procthread/process-creation-flags
+    use std::os::windows::process::CommandExt;
@@ #[cfg(windows)]
-    let output = Command::new(&icacls)
-        .arg(path)
-        .arg("/inheritance:r")
-        .arg("/grant:r")
-        .arg(user_grant)
-        .arg("/grant:r")
-        .arg(system_grant)
-        .arg("/remove")
-        .arg("*S-1-1-0")
-        .arg("*S-1-5-11")
-        .arg("*S-1-5-32-545")
-        .arg("/c")
-        .output()?;
+    let output = Command::new(&icacls)
+        .arg(path)
+        .arg("/inheritance:r")
+        .arg("/grant:r")
+        .arg(user_grant)
+        .arg("/grant:r")
+        .arg(system_grant)
+        .arg("/remove")
+        .arg("*S-1-1-0")
+        .arg("*S-1-5-11")
+        .arg("*S-1-5-32-545")
+        .arg("/c")
+        // Suppress any console window when executing icacls.exe
+        .creation_flags(0x08000000)
+        .stdin(Stdio::null())
+        .stdout(Stdio::piped())
+        .stderr(Stdio::piped())
+        .output()?;
*** End Patch
